var Interactor=function(config){this.__init__(config)};Interactor.prototype={__init__:function(config){var interactor=this;interactor.interactions=typeof config.interactions=="boolean"?config.interactions:true,interactor.interactionElement=typeof config.interactionElement=="string"?config.interactionElement:"interaction",interactor.interactionEvents=Array.isArray(config.interactionEvents)===true?config.interactionEvents:["mouseup","touchend"],interactor.conversions=typeof config.conversions=="boolean"?config.conversions:true,interactor.conversionElement=typeof config.conversionElement=="string"?config.conversionElement:"conversion",interactor.conversionEvents=Array.isArray(config.conversionEvents)===true?config.conversionEvents:["mouseup","touchend"],interactor.endpoint=typeof config.endpoint=="string"?config.endpoint:"/interactions",interactor.async=typeof config.async=="boolean"?config.async:true,interactor.debug=typeof config.debug=="boolean"?config.debug:true,interactor.records=[],interactor.session={},interactor.loadTime=new Date;interactor.__initializeSession__();interactor.__bindEvents__();return interactor},__bindEvents__:function(){console.log("binding events!");var interactor=this;if(interactor.interactions===true){for(var i=0;i<interactor.interactionEvents.length;i++){document.querySelector("body").addEventListener(interactor.interactionEvents[i],function(e){e.stopPropagation();console.log(e.target);if(e.target.classList.contains(interactor.interactionElement)){console.log("the element you clicked has interaction class");interactor.__addInteraction__(e,"interaction")}})}}if(interactor.conversions===true){for(var i=0;i<interactor.conversionEvents.length;i++){document.querySelector("body").addEventListener(interactor.conversionEvents[i],function(e){e.stopPropagation();if(e.target.classList.contains(interactor.conversionElement)){interactor.__addInteraction__(e,"conversion")}})}}window.onbeforeunload=function(e){interactor.__sendInteractions__()};return interactor},__addInteraction__:function(e,type){var interactor=this,interaction={type:type,event:e.type,targetTag:e.target.nodeName,targetClasses:e.target.className,content:e.target.innerText,clientPosition:{x:e.clientX,y:e.clientY},screenPosition:{x:e.screenX,y:e.screenY},createdAt:new Date};interactor.records.push(interaction);if(interactor.debug){interactor.__closeSession__();console.log("Session:\n",interactor.session)}return interactor},__initializeSession__:function(){var interactor=this;interactor.session={loadTime:interactor.loadTime,unloadTime:new Date,language:window.navigator.language,platform:window.navigator.platform,port:window.location.port,clientStart:{name:window.navigator.appVersion,innerWidth:window.innerWidth,innerHeight:window.innerHeight,outerWidth:window.outerWidth,outerHeight:window.outerHeight},page:{location:window.location.pathname,href:window.location.href,origin:window.location.origin,title:document.title},endpoint:interactor.endpoint};return interactor},__closeSession__:function(){var interactor=this;interactor.session.unloadTime=new Date;interactor.session.interactions=interactor.records;interactor.session.clientEnd={name:window.navigator.appVersion,innerWidth:window.innerWidth,innerHeight:window.innerHeight,outerWidth:window.outerWidth,outerHeight:window.outerHeight};return interactor},__sendInteractions__:function(){var interactor=this,xhr=new XMLHttpRequest;interactor.__closeSession__();xhr.open("POST",interactor.endpoint,interactor.async);xhr.setRequestHeader("Content-Type","application/json; charset=UTF-8");xhr.send(JSON.stringify(interactor.session));return interactor}};
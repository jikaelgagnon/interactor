(()=>{"use strict";var e={106:(e,t)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.SenderMethod=void 0,function(e){e.InitializeSession="Initialize Session",e.InteractionDetection="Interaction Detection",e.NavigationDetection="Navigation Detection",e.CloseSession="Close Session",e.Any="Any"}(o||(t.SenderMethod=o={}))},266:(e,t)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.ActivityType=void 0,function(e){e.SelfLoop="Self-Loop",e.StateChange="State Change",e.Interaction="Interaction",e.Both="Both"}(o||(t.ActivityType=o={}))},462:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtractorList=t.ExtractorData=t.ConfigLoader=void 0;const n=o(106);t.ExtractorData=class{constructor(e,t,o){this.eventType=e,this.urlPattern=t,this.extractor=o}};class i{constructor(e=[],t){this.extractors=e,this.baseURL=t}extract(e,t){console.log(`Attempting extraction for url: ${e} and event type ${t}`);let o={};return this.extractors.filter((o=>{const i=o.eventType==t||o.eventType==n.SenderMethod.Any,r=new URLPattern(o.urlPattern,this.baseURL).test(e);return i&&r})).forEach((e=>o=Object.assign(Object.assign({},o),e.extractor()))),o}}t.ExtractorList=i,t.ConfigLoader=class{constructor(e,t=[]){this.config=e,this.extractorList=new i(t,e.baseURL)}}},481:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(872),r=n(o(807)),s=n(o(615)),a=o(462),c=o(106),l=[new a.ExtractorData(c.SenderMethod.InteractionDetection,"/",(()=>({videos:Array.from(document.querySelectorAll("#content.ytd-rich-item-renderer")).filter((e=>{const t=e.getBoundingClientRect();return t.width>0&&t.height>0&&"hidden"!==getComputedStyle(e).visibility})).map((e=>{var t,o,n;const i=e.querySelector(":scope > yt-lockup-view-model a"),r=e.querySelector("h3 a span.yt-core-attributed-string");return{link:null!==(t=null==i?void 0:i.href)&&void 0!==t?t:"",title:null!==(n=null===(o=null==r?void 0:r.textContent)||void 0===o?void 0:o.trim())&&void 0!==n?n:""}})).filter((e=>""!==e.link))}))),new a.ExtractorData(c.SenderMethod.InteractionDetection,"/watch?v=*",(()=>(console.log("---- EXTRACTING RECOMMENDED LINKS ----"),{videos:Array.from(document.querySelectorAll("yt-lockup-view-model")).filter((e=>{const t=e.getBoundingClientRect();return t.width>0&&t.height>0&&"hidden"!==getComputedStyle(e).visibility})).map((e=>{var t,o,n;const i=e.querySelector('a[href^="/watch"]'),r=e.querySelector("h3 a span.yt-core-attributed-string");return{link:null!==(t=null==i?void 0:i.href)&&void 0!==t?t:"",title:null!==(n=null===(o=null==r?void 0:r.textContent)||void 0===o?void 0:o.trim())&&void 0!==n?n:""}})).filter((e=>""!==e.link))})))],d=new a.ConfigLoader(r.default,l);new i.Monitor(d);const u=new a.ConfigLoader(s.default,[]);new i.Monitor(u)},583:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageToBackground=void 0,t.MessageToBackground=class{constructor(e,t){this.senderMethod=e,this.payload=t}}},613:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SessionDocument=t.ActivityDocument=t.DBDocument=void 0;class o{constructor(e,t){this.sourceURL=e,this.sourceDocumentTitle=t}}t.DBDocument=o,t.ActivityDocument=class extends o{constructor(e,t,o,n,i){super(n,i),this.activityType=e,this.createdAt=new Date,this.eventType=t.type,this.metadata=o}},t.SessionDocument=class extends o{constructor(e,t){super(e,t),this.email=null,this.startTime=new Date}setEmail(e){this.email=e}}},615:e=>{e.exports=JSON.parse('{"baseURL":"https://jikaelgagnon.github.io","events":["click"],"paths":{"/*":[{"selector":".nav-link[href=\'/blog/\']","name":"Blog Link"}]}}')},807:e=>{e.exports=JSON.parse('{"baseURL":"https://www.youtube.com","events":["click"],"paths":{"/*":[{"selector":"#logo-icon","name":"YouTube Logo"},{"selector":"ytm-shorts-lockup-view-model-v2","name":"Shorts on Miniplayer"},{"selector":"div#chip-shape-container, yt-tab-shape[tab-title]","name":"Category Button"},{"selector":"div#left-arrow-button","name":"Category back button"},{"selector":"div#right-arrow-button","name":"Category forward button"},{"selector":"a.yt-simple-endpoint.style-scope.ytd-guide-entry-renderer#endpoint, a.yt-simple-endpoint.style-scope.ytd-mini-guide-entry-renderer#endpoint","name":"Side Navigation Button"},{"selector":"yt-icon-button#guide-button","name":"Guide Button"},{"selector":"ytd-video-renderer, ytd-rich-item-renderer","name":"Video"},{"selector":"yt-lockup-view-model","name":"Content Collection"}],"/":[],"/feed/*":[{"selector":"ytd-video-renderer[is-history]","name":"History Video"},{"selector":"ytd-grid-movie-renderer","name":"Movie Thumbnail"}],"/channel/*":[{"selector":"ytd-default-promo-panel-renderer","name":"Promo Video"}],"/@:id{/*}?":[{"selector":"yt-tab-shape[tab-title=\\"Home\\"]","name":"Creator Home"},{"selector":"yt-tab-shape[tab-title=\\"Videos\\"]","name":"Creator Videos"},{"selector":"yt-tab-shape[tab-title=\\"Playlists\\"]","name":"Creator Playlists"},{"selector":"yt-tab-shape[tab-title=\\"Shorts\\"]","name":"Creator Shorts"},{"selector":"yt-tab-shape[tab-title=\\"Live\\"]","name":"Creator Live"},{"selector":"yt-tab-shape[tab-title=\\"Posts\\"]","name":"Creator Posts"},{"selector":"div.yt-subscribe-button-view-model-wiz__container","name":"Creator Subscribe Button"},{"selector":"ytd-video-renderer.style-scope.ytd-channel-featured-content-renderer","name":"Creator Featured Video"},{"selector":"ytd-grid-video-renderer.style-scope.yt-horizontal-list-renderer","name":"Creator Video"}],"/playlist?list=*":[{"selector":"div#content.style-scope.ytd-playlist-video-renderer","name":"Video Inside Playlist"}],"/shorts/:id":[{"selector":"#like-button[is-shorts]","name":"Shorts Like Button"},{"selector":"#dislike-button[is-shorts]","name":"Shorts Dislike Button"},{"selector":"div#comments-button","name":"Comments Button"},{"selector":"ytd-player#player","name":"Shorts Video Player"}],"/watch?v=*":[{"selector":"ytd-compact-video-renderer.style-scope.ytd-item-section-renderer","name":"Watch Page Recommended Video"},{"selector":"ytd-toggle-button-renderer#dislike-button","name":"Comment Dislike Button"},{"selector":"ytd-toggle-button-renderer#like-button","name":"Comment Like Button"},{"selector":"ytd-video-owner-renderer.style-scope.ytd-watch-metadata","name":"Channel Link"},{"selector":"like-button-view-model.ytLikeButtonViewModelHost","name":"Video Like Button"},{"selector":"dislike-button-view-model.ytDislikeButtonViewModelHost","name":"Video Dislike Button"},{"selector":"div#subscribe-button","name":"Subscribe Button"},{"selector":"div#player","name":"Video Player"},{"selector":"button[title=\'Share\']","name":"Share Button"}],"/results?search_query=*":[{"selector":"ytd-video-renderer.style-scope.ytd-vertical-list-renderer","name":"Top Search Page Video"},{"selector":"ytd-video-renderer.style-scope.ytd-item-section-renderer","name":"Search Page Video"},{"selector":"yt-lockup-view-model.ytd-item-section-renderer","name":"Playlist"}]}}')},872:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Monitor=void 0;const i=o(583),r=o(613),s=o(935),a=o(266),c=o(106);t.Monitor=class{constructor(e){var t;this.StringToColor=function(){let e=null;return{next:function(t){return null!=e||(e={stringToColorHash:{},nextVeryDifferntColorIdx:0,veryDifferentColors:["#00FF00","#0000FF","#FF0000","#01FFFE","#FFA6FE","#FFDB66","#006401","#010067","#95003A","#007DB5","#FF00F6","#FFEEE8","#774D00","#90FB92","#0076FF","#D5FF00","#FF937E","#6A826C","#FF029D","#FE8900","#7A4782","#7E2DD2","#85A900","#FF0056","#A42400","#00AE7E","#683D3B","#BDC6FF","#263400","#BDD393","#00B917","#9E008E","#001544","#C28C9F","#FF74A3","#01D0FF","#004754","#E56FFE","#788231","#0E4CA1","#91D0CB","#BE9970","#968AE8","#BB8800","#43002C","#DEFF74","#00FFC6","#FFE502","#620E00","#008F9C","#98FF52","#7544B1","#B500FF","#00FF78","#FF6E41","#005F39","#6B6882","#5FAD4E","#A75740","#A5FFD2","#FFB167","#009BFF","#E85EBE"]}),e.stringToColorHash[t]||(e.stringToColorHash[t]=e.veryDifferentColors[e.nextVeryDifferntColorIdx++],console.log(`%c The colour for ${t}`,`color: ${e.stringToColorHash[t]}`)),e.stringToColorHash[t]}}}();const o=e.config;this.htmlEventsToMonitor=null!==(t=o.events)&&void 0!==t?t:["click"],this.enableHighlighting=!0,this.currentPageData=new s.PageData(o),this.htmlMonitoringAttribute="monitoring-interactions",this.extractorList=e.extractorList,window.location.origin===o.baseURL&&this.intitializeWhenVisible()}intitializeWhenVisible(){const e=()=>{"visible"===document.visibilityState&&this.initializeMonitor().then((()=>{document.removeEventListener("visibilitychange",e)})).catch((t=>{console.error("Error initializing monitor:",t),document.removeEventListener("visibilitychange",e)}))};"complete"===document.readyState?e():window.addEventListener("load",(()=>{e()})),document.addEventListener("visibilitychange",e)}initializeMonitor(){return n(this,void 0,void 0,(function*(){console.log("initializing monitor"),this.currentPageData.update(document.location.href);try{yield this.initializeSession(),this.bindEvents()}catch(e){console.error("Failed to initialize session:",e)}}))}initializeSession(){return n(this,void 0,void 0,(function*(){const e=new r.SessionDocument(this.currentPageData.currentURL,document.title);console.log("Checking highlight");const t=yield this.sendMessageToBackground(c.SenderMethod.InitializeSession,e);t&&"Session initialized"===(null==t?void 0:t.status)&&t.highlight&&(this.enableHighlighting=t.highlight),console.log(`Highlight is set to ${this.enableHighlighting}`)}))}bindEvents(){new MutationObserver((()=>this.addListenersToNewMatches())).observe(document.body,{childList:!0,subtree:!0}),navigation.addEventListener("navigate",(e=>this.onNavigationDetection(e)))}addListenersToNewMatches(){this.currentPageData.selectorNamePairs.forEach((e=>{const t=document.querySelectorAll(`:is(${e.selector}):not([${this.htmlMonitoringAttribute}])`),o=e.name;for(const e of t){this.enableHighlighting&&(e.style.border=`2px solid ${this.StringToColor.next(o)}`),e.setAttribute(this.htmlMonitoringAttribute,"true");for(const t of this.htmlEventsToMonitor)e.addEventListener(t,(t=>{this.onInteractionDetection(e,t,o)}),!0)}}))}createNavigationRecord(e,t){const o=this.extractorList.extract(this.currentPageData.currentURL,c.SenderMethod.NavigationDetection);return console.log("printing metadata"),console.log(o),new r.ActivityDocument(e,t,o,this.currentPageData.currentURL,document.title)}createInteractionRecord(e,t){console.log("Detected interaction event");const o={elementName:e},n=this.extractorList.extract(this.currentPageData.currentURL,c.SenderMethod.InteractionDetection),i=Object.assign(Object.assign({},o),n);return console.log("printing metadata"),console.log(i),new r.ActivityDocument(a.ActivityType.Interaction,t,i,this.currentPageData.currentURL,document.title)}sendMessageToBackground(e,t){return n(this,void 0,void 0,(function*(){var o;try{if(!(null===(o=chrome.runtime)||void 0===o?void 0:o.id))throw new Error("Extension context invalidated");const n=new i.MessageToBackground(e,t),r=yield chrome.runtime.sendMessage(n);return void 0===r&&console.error("No response from background script"),r}catch(e){return console.error("Background message failed:",e),null}}))}onInteractionDetection(e,t,o){console.log("interaction event detected"),console.log(`Event detected with event type: ${t.type}`),console.log("Event triggered by",e);const n=this.createInteractionRecord(o,t);this.sendMessageToBackground(c.SenderMethod.InteractionDetection,n).catch((e=>{console.error("Failed to send interaction data:",e)}))}isNewBaseURL(e){if(console.log("checking if url updated"),null===e)return console.log("new url is null"),!1;const t=new URL(this.currentPageData.currentURL).hostname,o=new URL(e).hostname;return console.log("current hostname",t),console.log("new hostname",o),t!==o}onNavigationDetection(e){const t=e.destination.url,o=this.isNewBaseURL(t);let n,i;console.log(`before creating nav record, current URL is ${this.currentPageData.currentURL}`),o?(console.log("URL base change detected. Closing program."),n=new r.DBDocument(this.currentPageData.currentURL,document.title),i=c.SenderMethod.CloseSession):"push"===e.navigationType?(console.log("Push event detected."),n=this.createNavigationRecord(a.ActivityType.StateChange,e),i=c.SenderMethod.NavigationDetection):"replace"===e.navigationType&&(console.log("Replace event detected."),n=this.createNavigationRecord(a.ActivityType.SelfLoop,e),i=c.SenderMethod.NavigationDetection),console.log(`after creating nav record, current URL is ${this.currentPageData.currentURL}`),t&&this.currentPageData.update(t),console.log(`at end of on nav detect, current URL is ${this.currentPageData.currentURL}`),void 0!==n&&void 0!==i&&this.sendMessageToBackground(i,n).catch((e=>{console.error("Failed to send interaction data:",e)}))}}},935:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PageData=void 0,t.PageData=class{constructor(e){this.urlPatternToSelectorData=e.paths,this.baseURL=e.baseURL}update(e){this.currentURL=e;const t=this.getMatchingPatterns();this.selectorNamePairs=this.getSelectorNamePairs(t)}getMatchingPatterns(){console.log("updating page data");const e=Object.keys(this.urlPatternToSelectorData).filter((e=>new URLPattern(e,this.baseURL).test(this.currentURL)));return 0===e.length&&console.log("no matches found"),e}getSelectorNamePairs(e){let t=[];for(const o of e){const e=this.urlPatternToSelectorData[o];t=t.concat(e)}return t}}}},t={};!function o(n){var i=t[n];if(void 0!==i)return i.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,o),r.exports}(481)})();
//# sourceMappingURL=content.js.map